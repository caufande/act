{"version":3,"file":"dom.js","sources":["../../src/utils/dom.ts"],"sourcesContent":["import { createSelectorQuery } from '@tarojs/taro'\n\nexport function getRectSize (id: string, success?: TFunc, fail?: TFunc, retryMs = 500) {\n  const query = createSelectorQuery()\n  try {\n    query.select(id).boundingClientRect((res) => {\n      if (res instanceof Array ? res.length > 0 : res) {\n        success?.(res)\n      } else {\n        fail?.()\n      }\n    }).exec()\n  } catch (err) {\n    setTimeout(() => {\n      getRectSize(id, success, fail, retryMs)\n    }, retryMs)\n  }\n}\n\nexport function getRectSizeSync (id: string, retryMs = 500, retryTimes = 5) {\n  return new Promise<{ width?: number, height?: number }>((resolve) => {\n    function retry () {\n      if (retryTimes <= 0) return\n      setTimeout(async () => {\n        try {\n          const res = await getRectSizeSync(id, retryMs, --retryTimes)\n          resolve(res)\n        } catch (err) {\n          retry()\n        }\n      }, retryMs)\n    }\n    getRectSize(id, resolve, retry, retryMs)\n  })\n}\n\nexport async function getScrollViewContextNode (id: string) {\n  const query = createSelectorQuery()\n  return new Promise((resolve) => query.select(id).node(({ node }) => resolve(node)).exec())\n}\n"],"names":[],"mappings":";;AAEM,SAAU,WAAW,CAAE,EAAU,EAAE,OAAe,EAAE,IAAY,EAAE,OAAO,GAAG,GAAG,EAAA;AACnF,IAAA,MAAM,KAAK,GAAG,mBAAmB,EAAE,CAAA;AACnC,IAAA,IAAI;QACF,KAAK,CAAC,MAAM,CAAC,EAAE,CAAC,CAAC,kBAAkB,CAAC,CAAC,GAAG,KAAI;AAC1C,YAAA,IAAI,GAAG,YAAY,KAAK,GAAG,GAAG,CAAC,MAAM,GAAG,CAAC,GAAG,GAAG,EAAE;AAC/C,gBAAA,OAAO,aAAP,OAAO,KAAA,KAAA,CAAA,GAAA,KAAA,CAAA,GAAP,OAAO,CAAG,GAAG,CAAC,CAAA;aACf;iBAAM;AACL,gBAAA,IAAI,KAAJ,IAAA,IAAA,IAAI,KAAJ,KAAA,CAAA,GAAA,KAAA,CAAA,GAAA,IAAI,EAAI,CAAA;aACT;AACH,SAAC,CAAC,CAAC,IAAI,EAAE,CAAA;KACV;IAAC,OAAO,GAAG,EAAE;QACZ,UAAU,CAAC,MAAK;YACd,WAAW,CAAC,EAAE,EAAE,OAAO,EAAE,IAAI,EAAE,OAAO,CAAC,CAAA;SACxC,EAAE,OAAO,CAAC,CAAA;KACZ;AACH,CAAC;AAEK,SAAU,eAAe,CAAE,EAAU,EAAE,OAAO,GAAG,GAAG,EAAE,UAAU,GAAG,CAAC,EAAA;AACxE,IAAA,OAAO,IAAI,OAAO,CAAsC,CAAC,OAAO,KAAI;AAClE,QAAA,SAAS,KAAK,GAAA;YACZ,IAAI,UAAU,IAAI,CAAC;gBAAE,OAAM;YAC3B,UAAU,CAAC,YAAW;AACpB,gBAAA,IAAI;AACF,oBAAA,MAAM,GAAG,GAAG,MAAM,eAAe,CAAC,EAAE,EAAE,OAAO,EAAE,EAAE,UAAU,CAAC,CAAA;oBAC5D,OAAO,CAAC,GAAG,CAAC,CAAA;iBACb;gBAAC,OAAO,GAAG,EAAE;AACZ,oBAAA,KAAK,EAAE,CAAA;iBACR;aACF,EAAE,OAAO,CAAC,CAAA;SACZ;QACD,WAAW,CAAC,EAAE,EAAE,OAAO,EAAE,KAAK,EAAE,OAAO,CAAC,CAAA;AAC1C,KAAC,CAAC,CAAA;AACJ,CAAC;AAEM,eAAe,wBAAwB,CAAE,EAAU,EAAA;AACxD,IAAA,MAAM,KAAK,GAAG,mBAAmB,EAAE,CAAA;AACnC,IAAA,OAAO,IAAI,OAAO,CAAC,CAAC,OAAO,KAAK,KAAK,CAAC,MAAM,CAAC,EAAE,CAAC,CAAC,IAAI,CAAC,CAAC,EAAE,IAAI,EAAE,KAAK,OAAO,CAAC,IAAI,CAAC,CAAC,CAAC,IAAI,EAAE,CAAC,CAAA;AAC5F;;;;"}