{"version":3,"file":"index.js","sources":["../../src/interceptor/index.ts"],"sourcesContent":["import Chain from './chain'\n\nimport type { IRequestParams, TInterceptor } from './chain'\n\nexport default class Link {\n  taroInterceptor: TInterceptor\n  chain: Chain\n\n  constructor (interceptor: TInterceptor) {\n    this.taroInterceptor = interceptor\n    this.chain = new Chain()\n  }\n\n  request (requestParams: IRequestParams) {\n    const chain = this.chain\n    const taroInterceptor = this.taroInterceptor\n\n    chain.interceptors = chain.interceptors\n      .filter(interceptor => interceptor !== taroInterceptor)\n      .concat(taroInterceptor)\n\n    return chain.proceed({ ...requestParams })\n  }\n\n  addInterceptor (interceptor: TInterceptor) {\n    this.chain.interceptors.push(interceptor)\n  }\n\n  cleanInterceptors () {\n    this.chain = new Chain()\n  }\n}\n\nexport function interceptorify (promiseifyApi) {\n  return new Link(function (chain) {\n    return promiseifyApi(chain.requestParams)\n  })\n}\n"],"names":[],"mappings":";;AAIc,MAAO,IAAI,CAAA;AAIvB,IAAA,WAAA,CAAa,WAAyB,EAAA;AACpC,QAAA,IAAI,CAAC,eAAe,GAAG,WAAW,CAAA;AAClC,QAAA,IAAI,CAAC,KAAK,GAAG,IAAI,KAAK,EAAE,CAAA;KACzB;AAED,IAAA,OAAO,CAAE,aAA6B,EAAA;AACpC,QAAA,MAAM,KAAK,GAAG,IAAI,CAAC,KAAK,CAAA;AACxB,QAAA,MAAM,eAAe,GAAG,IAAI,CAAC,eAAe,CAAA;AAE5C,QAAA,KAAK,CAAC,YAAY,GAAG,KAAK,CAAC,YAAY;aACpC,MAAM,CAAC,WAAW,IAAI,WAAW,KAAK,eAAe,CAAC;aACtD,MAAM,CAAC,eAAe,CAAC,CAAA;AAE1B,QAAA,OAAO,KAAK,CAAC,OAAO,CAAM,MAAA,CAAA,MAAA,CAAA,EAAA,EAAA,aAAa,EAAG,CAAA;KAC3C;AAED,IAAA,cAAc,CAAE,WAAyB,EAAA;QACvC,IAAI,CAAC,KAAK,CAAC,YAAY,CAAC,IAAI,CAAC,WAAW,CAAC,CAAA;KAC1C;IAED,iBAAiB,GAAA;AACf,QAAA,IAAI,CAAC,KAAK,GAAG,IAAI,KAAK,EAAE,CAAA;KACzB;AACF,CAAA;AAEK,SAAU,cAAc,CAAE,aAAa,EAAA;AAC3C,IAAA,OAAO,IAAI,IAAI,CAAC,UAAU,KAAK,EAAA;AAC7B,QAAA,OAAO,aAAa,CAAC,KAAK,CAAC,aAAa,CAAC,CAAA;AAC3C,KAAC,CAAC,CAAA;AACJ;;;;"}