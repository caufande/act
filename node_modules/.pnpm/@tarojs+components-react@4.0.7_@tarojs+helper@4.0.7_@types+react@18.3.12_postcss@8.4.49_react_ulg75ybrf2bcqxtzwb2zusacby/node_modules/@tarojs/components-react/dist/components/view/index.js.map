{"version":3,"file":"index.js","sources":["../../../src/components/view/index.tsx"],"sourcesContent":["import classNames from 'classnames'\n\nimport { useEffect, useState } from '../../utils/hooks'\nimport { createForwardRefComponent } from '../../utils/index'\n\nimport type { TFunc } from '@tarojs/runtime/dist/runtime.esm'\nimport type React from 'react'\n\ninterface IProps extends React.HTMLAttributes<HTMLDivElement> {\n  hoverClass?: string\n  hoverStartTime?: number\n  hoverStayTime?: number\n  onTouchStart?(e: React.TouchEvent<HTMLDivElement>): void\n  onTouchEnd?(e: React.TouchEvent<HTMLDivElement>): void\n  onTouchMove?(e: React.TouchEvent<HTMLDivElement>): void\n  onLongPress?(): void\n  forwardedRef?: React.MutableRefObject<HTMLDivElement>\n}\n\nfunction View ({\n  className,\n  hoverClass,\n  forwardedRef,\n  onTouchStart,\n  onTouchEnd,\n  onTouchMove,\n  hoverStartTime = 50,\n  hoverStayTime = 400,\n  ...other\n}: IProps) {\n  let timeoutEvent: ReturnType<typeof setTimeout>\n  let startTime = 0\n  const [hover, setHover] = useState<boolean>(false)\n  const [touch, setTouch] = useState<boolean>(false)\n\n  const [cls, setCls] = useState<string>(classNames(\n    '',\n    {\n      [`${hoverClass}`]: process.env.FRAMEWORK === 'solid' ? (hover as unknown as TFunc)() : hover\n    },\n    className\n  ))\n\n  const _onTouchStart = e => {\n    if (hoverClass) {\n      setTouch(true)\n      setTimeout(() => {\n        if (process.env.FRAMEWORK === 'solid' ? (touch as unknown as TFunc)() : touch) {\n          setHover(true)\n        }\n      }, hoverStartTime)\n    }\n    onTouchStart && onTouchStart(e)\n    if (other.onLongPress) {\n      timeoutEvent = setTimeout(() => {\n        other.onLongPress!()\n      }, 350)\n      startTime = new Date().getTime()\n    }\n  }\n\n  const _onTouchMove = e => {\n    clearTimeout(timeoutEvent)\n    onTouchMove && onTouchMove(e)\n  }\n\n  const _onTouchEnd = e => {\n    const spanTime = new Date().getTime() - startTime\n    if (spanTime < 350) {\n      clearTimeout(timeoutEvent)\n    }\n    if (hoverClass) {\n      setTouch(false)\n      setTimeout(() => {\n        if (process.env.FRAMEWORK === 'solid' ? (touch as unknown as TFunc)() : touch) {\n          setHover(false)\n        }\n      }, hoverStayTime)\n    }\n    onTouchEnd && onTouchEnd(e)\n  }\n\n  useEffect(() => {\n    setCls(classNames(\n      '',\n      {\n        [`${hoverClass}`]: process.env.FRAMEWORK === 'solid' ? (hover as unknown as TFunc)() : hover\n      },\n      className\n    ))\n  }, [hover, className])\n\n  return (\n    <div\n      ref={forwardedRef}\n      className={process.env.FRAMEWORK === 'solid' ? (cls as unknown as TFunc)() : cls as string}\n      onTouchStart={_onTouchStart}\n      onTouchEnd={_onTouchEnd}\n      onTouchMove={_onTouchMove}\n      {...other}\n    >\n      {other.children}\n    </div>\n  )\n}\n\n\nexport default createForwardRefComponent(View)\n"],"names":["View","_a","className","hoverClass","forwardedRef","onTouchStart","onTouchEnd","onTouchMove","hoverStartTime","hoverStayTime","other","__rest","timeoutEvent","startTime","hover","setHover","useState","touch","setTouch","cls","setCls","classNames","process","_onTouchStart","e","setTimeout","onLongPress","Date","getTime","_onTouchMove","clearTimeout","_onTouchEnd","spanTime","useEffect","_jsx","ref","children","createForwardRefComponent"],"mappings":"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"}